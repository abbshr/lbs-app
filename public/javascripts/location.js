// Generated by CoffeeScript 1.9.3
(function() {
  var geo, info, url;

  url = function(lng, lat, distance, limit) {
    return "/api/near?lng=" + lng + "&lat=" + lat + "&distance=" + distance + "&limit=" + limit;
  };

  info = function(lng, lat, accuracy) {
    return "当前位置: (" + lng + ", " + lat + "), 精确度: " + accuracy + "\n";
  };

  geo = new Geo;

  window.onload = function() {
    return geo.getCurrent(function(pos) {
      initialize(pos.longitude, pos.latitude);
      console.log(info(pos.longitude, pos.latitude, pos.accuracy));
      return fetch(url(pos.longitude, pos.latitude, 2000, 100)).then(function(res) {
        if (res.status === 200) {
          return res.text().then(function(data) {
            return console.log(data);
          });
        }
      })["catch"](function(err) {
        return console.log(err);
      });
    });
  };

}).call(this);
